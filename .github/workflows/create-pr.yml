name: 'Create PR'
# https://github.com/thomaseizinger/create-pull-request

on:
  create:
    branches:
      - '**'

jobs:
  create-pr-on-push:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2.3.4
        if: |
          contains(github.head_ref, 'einSelbst') == false &&
          contains(github.head_ref, 'dependabot') == false &&
          contains(github.head_ref, 'renovate') == false

      - name: Extract branch name
        if: |
          startsWith(github.head_ref, 'einselbst') == false &&
          startsWith(github.head_ref, 'dependabot') == false &&
          startsWith(github.head_ref, 'renovate') == false
        shell: bash
        run: echo "##[set-output name=branch;]$(echo ${GITHUB_REF#refs/heads/})"
        id: extract_branch

      - name: Create pull request
        if: |
          startsWith(github.head_ref, 'einselbst') == false &&
          startsWith(github.head_ref, 'dependabot') == false &&
          startsWith(github.head_ref, 'renovate') == false
        uses: thomaseizinger/create-pull-request@master
        with:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          head: ${{ github.ref }}
          base: master
          title: ${{ steps.extract_branch.outputs.branch }}
